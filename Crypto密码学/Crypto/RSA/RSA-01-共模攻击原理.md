# RSA共模攻击原理

*2021/11/16 By Jason.J.Hu*

## 场景

两个及以上的公钥(n,e)来加密同一条信息m

```python
c1 = pow(m, e1, n)
c2 = pow(m, e2, n)
```

e1，e2互质，则有

```python
gcd(e1,e2)=1
```
## 推导过程

根据扩展欧几里德算法 对于不完全为 0 的整数 a，b，gcd（a，b）表示 a，b 的最大公约数。那么一定存在整数 x，y 使得 gcd（a，b）=ax+by

```python
e1*s1+e2*s2 = 1
```

s1、s2皆为整数，但是一正一负，假设s1为正数,s2为负数

因为

```javascript
c1 = m^e1%n
c2 = m^e2%n
```

可得：

```javascript
(c1^s1*c2^s2)%n = ((m^e1%n)^s1(m^e2%n)^s2)%n
```

根据模运算性质： 幂运算是一种关于幂的数学运算。同底数幂相乘，底数不变，指数相加。同底数幂相除，底数不变，指数相减。幂的乘方，底数不变，指数相乘。

```javascript
(a * b) % p = (a % p * b % p) % p
a ^ b % p = ((a % p) ^ b) % p
```

简化公式为：

```python
(c1^s1*c2^s2)%n = ((m^e1%n)^s1*(m^e2%n)^s2)%n

=> (c1^s1*c2^s2)%n = ((m^e1%n)^s1%n*(m^e2%n)^s2%n)%n 
#(a * b) % p = (a % p * b % p) % p

=> (c1^s1*c2^s2)%n = ((m^e1)^s1%n*(m^e2)^s2%n)%n 
#((a % p) ^ b) % p =a ^ b % p

=> (c1^s1*c2^s2)%n = ((m^e1)^s1*(m^e2)^s2)%n 
# (a % p * b % p) % p=(a * b) % p

=>(c1^s1*c2^s2)%n = ((m^(e1*s1)*(m^(e2*s2))%n 
#。幂的乘方，底数不变，指数相乘。

(c1^s1*c2^s2)%n = (m^(e1*s1+e2*s2))%n  
# 同底数幂相乘，底数不变，指数相加。
```

因为 e1*s1+e2*s2 = 1 得：

```python
(c1^s1*c2^s2)%n = (m^1)%n

(c1^s1*c2^s2）%n=m
```

上述就是rsa共模攻击的过程

因此，同一m，同一n,不同e，进行加密。在不需要知道d的情况下，可以进行解密。
